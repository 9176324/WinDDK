<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>FFDRV1 DDK Sample</TITLE>
<META http-equiv=Content-Language content=en-us>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="MSHTML 6.00.2900.2523" name=GENERATOR></HEAD>
<BODY><FONT face=Verdana size=5>
<H2>FFDRV1 DDK Sample</H2></FONT><FONT face=Verdana size=2>
<H3>SUMMARY</H3>
<H3><SPAN style="FONT-WEIGHT: 400"><FONT size=2>FFDRV1 is a sample DirectInput 
ring-3 force feedback<BR>effect driver written in C, as well as a 
fully-commented INF file to<BR>illustrate the registry keys used by force 
feedback.</FONT></SPAN></H3>
<H3>USING THE SAMPLE</H3>
<H3><SPAN style="FONT-WEIGHT: 400"><FONT size=2>Search for the string !!IHV!! 
for things that you definitely must<BR>change before modifying this driver to 
suit your hardware.<BR><BR>Note that the code here is specifically optimized to 
be used in a DLL that<BR>is a DirectInput force feedback effect driver and 
*nothing else*. Do not<BR>try to add additional interfaces or CLSIDs to the 
sample, because the<BR>sample takes various shortcuts to make the code 
simpler.<BR><BR>The optimizations here are based on the assumption that 
management of a<BR>force feedback device is global in scope, so no interfaces 
will require<BR>per-instance data. This is in general not true, which is why the 
code<BR>is not suitable as a sample for a more general-purpose OLE in-proc 
server.<BR><BR>To test the sample driver (which doesn't do anything, but hey, if 
you<BR>want to test it be my guest), follow these steps:<BR><BR>Step 1 - Build 
the binary<BR><BR>- If you are using the Platform SDK, make sure that the 
files<BR><BR>c:\mssdk\include\dinput.h<BR>c:\mssdk\include\dinputd.h<BR>c:\mssdk\lib\dxguid.lib<BR><BR>are 
the DirectX 5.0 versions or later of the files rather than the DirectX 
3.0<BR>versions.<BR>- Type "build -cz".<BR>- Copy the generated FFDRV1.DLL to 
the same directory that contains<BR>a copy of the FFDRV1.INF file.<BR><BR>Step 2 
- Installing the files<BR><BR>- Navigate to the directory that contains both 
ffdrv1.dll and ffdrv1.inf.<BR>- Right-click ffdrv1.inf and choose 
Install.<BR><BR><BR>Step 3 - Installing a joystick associated with the 
driver.<BR><BR>- Get a standard analog joystick and plug it in. Make sure it 
works<BR>with the standard analog joystick driver.<BR>- Open the Gaming Options 
control panel.<BR>- Click the Add... button, then scroll down to the "XYZZY 
Force <BR>Feedback Joystick" entry. <BR>- Select the joystick and click the Ok 
button to install it.<BR><BR>You can now make force feedback API calls, and the 
sample driver<BR>will service the requests. The sample driver does everything 
a<BR>real driver would need to do, except that at the last minute, instead<BR>of 
actually sending the command to a piece of hardware, it just prints<BR>to the 
debugger terminal the command bytes it would have 
sent.<BR>&nbsp;</FONT></SPAN></H3>
<H3>CODE TOUR</H3>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">clsfact.c</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">default.mak</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">effdrv.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//Effects Driver</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">effdrv.h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//Common Header for the template effect driver</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">effhw.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//Fake hardware module.</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">effpub.h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//Header file that you would ship with your hardware SDK.</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">ffdrv1.def</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">ffdrv1.inf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//INF for sample force feedback joystick driver</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">ffdrv1.rc</P>
<P 
style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">main.c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
//Template effect driver</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">makefile</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">makefile1</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">makefile.wat</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">sources</P>
<P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px">watcom.mk</P></FONT><FONT 
face=Courier size=3><FONT face=Verdana size=2>
<H3>FEEDBACK</H3>
<P>We welcome your comments, problem reports and wish-list requests. Please 
submit them by pointing your Internet browser to <A 
href="http://www.microsoft.com/ddk">http://www.microsoft.com/ddk</A>. 
</FONT></P>
<TABLE cellSpacing=0 width=624 border=0>
  <TBODY>
  <TR>
    <TD vAlign=center bgColor=#00ffff height=2></TD></TR></TBODY></TABLE><FONT 
face="MS Sans Serif" size=1>
<P>© Microsoft Corporation 2004</FONT><FONT face=Verdana size=2> 
</P></FONT></FONT></BODY></HTML>
