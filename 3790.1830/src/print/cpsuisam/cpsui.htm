<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="cpsui_files/filelist.xml">
<title>CPSUI</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"MS Sans Serif";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Times New Roman";
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h2
	{color:black;}
h3
	{color:black;}
h4
	{color:black;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
pre
	{margin-top:0in;
	margin-bottom:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta name=Template content="C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\html.dot">
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'
leftmargin=8>

<div class=Section1>

<h2><a name=MYSAMPLE><span style='font-family:Verdana'>CPSUI</span></a><span
style='font-family:Verdana'> <o:p></o:p></span></h2>

<h3><span style='font-family:Verdana'>SUMMARY<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>The Common Property Sheet
User Interface (CPSUI) is a user-mode dynamic link library that enables
developers to create property sheet pages that have a standard appearance. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>This application causes
CPSUI to call the Windows® 2000/Windows® XP/Windows® Server 2003 print spooler
to create property sheet pages for the system's default printer. Note that printer
interface DLLs should not do this. The application then creates an additional
property sheet page to illustrate some of the techniques that can be employed when
using <span class=GramE>CPSUI to create a new page.</span> <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>BUILDING THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample requires that
the Windows® 2000/Windows® XP/Windows® Server 2003 Software Development Kit and
Driver Development Kit be installed so that the required headers and <span
class=SpellE>libs</span> are available. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>To build the samples, run
<b>build</b> from this directory. The DLL will be placed in the appropriate
platform directory.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>Once built, the sample
produces one binary: Cpsuisam.exe. The sample is 64-bit compliant and compiles
properly with Microsoft® Visual C® 6.0. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>CODE TOUR<o:p></o:p></span></h3>

<h4><span style='font-family:Verdana'>File Manifest<o:p></o:p></span></h4>

<pre><o:p>&nbsp;</o:p></pre><pre><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></pre><pre><u><span
style='font-family:Courier'>Files<span style='mso-spacerun:yes'>          </span>Description</span></u><span
style='font-family:Courier'><o:p></o:p></span></pre><pre><span class=SpellE><span
style='font-family:Courier'>Apple.ico</span></span><span style='font-family:
Courier'><span style='mso-spacerun:yes'>      </span>The <span class=GramE>resource file</span> for a sample icon<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuidat.cpp</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>   </span>The source file that contains all the predefined data<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuidat.h</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>     </span>The <span
class=GramE>header file</span> for <span class=SpellE>CPSUIDAT.cpp</span><o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuisam.c</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>     </span>The source file that implements the sample for the Windows 2000 CPSUI<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuisam.def</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>   </span>The file that lists the exported functions<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuisam.dlg</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>   </span>The <span
class=GramE>resource file</span> for the dialogs<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuisam.h</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>     </span>The <span
class=GramE>header file</span> for <span class=SpellE>CPSUISAM.c</span><o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Cpsuisam.ico</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>   </span>The <span
class=GramE>resource file</span> for a sample icon<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Debug.c</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>        </span>The <span
class=GramE>source file</span> for debugging functions<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Debug.h</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>        </span>The header for <span
class=SpellE>Debug.c</span><o:p></o:p></span></pre><pre><span class=SpellE><span
style='font-family:Courier'>Makefile</span></span><span style='font-family:
Courier'><span style='mso-spacerun:yes'>       </span>The generic file for building the code sample<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Precomp.h</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>      </span>The header that includes the headers to pre-compile<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Cpsui.htm<span style='mso-spacerun:yes'>      </span>The documentation for this sample (this file)<o:p></o:p></span></pre><pre><span
class=SpellE><span style='font-family:Courier'>Res.rc</span></span><span
style='font-family:Courier'><span style='mso-spacerun:yes'>         </span>The <span
class=GramE>resource file</span> for the module<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Sources<span style='mso-spacerun:yes'>        </span>The generic file for building the code sample<o:p></o:p></span></pre>

<p align=center style='text-align:center'><a href="#top"><span
style='font-size:10.0pt;font-family:Verdana'>Top of page</span></a><span
style='font-size:10.0pt;font-family:Verdana'> <o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=624
 style='width:6.5in;mso-cellspacing:0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:1.5pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:1.5pt'>
  <p class=MsoNormal><o:p>&nbsp;</o:p></p>
  </td>
 </tr>
</table>

<p><span style='font-size:7.5pt;font-family:"MS Sans Serif"'>© 2004 Microsoft
Corporation</span><span style='font-size:10.0pt;font-family:Verdana'> <o:p></o:p></span></p>

</div>

</body>

</html>

