<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="readme142_files/filelist.xml">
<title>Audio Control Panel Application Sample</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"MS Sans Serif";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin-top:0in;
	margin-bottom:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<h2><span style='font-family:Verdana'>Audio Control Panel Application Sample<o:p></o:p></span></h2>

<h3><span style='font-family:Verdana'>SUMMARY<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample illustrates
the basics of writing a control panel application. The sample only works in
conjunction with the AC97 property page sample, which in turn requires the AC97
WDM audio driver sample. The AC97 WDM audio driver sample runs on an Intel®
motherboard with integrated AC97 controller (for example, the Intel 810 chip set).
<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>Microsoft discourages the
use of control panel applications because cluttering of the control panel is
confusing to most users. Most of the functionality that you might want to
provide can be added in a property sheet that is added to the property page of
your device. To learn how to write a property page DLL, see the <span
class=SpellE><i>proppage</i></span> sample. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>Microsoft also
discourages the use of system tray programs (programs that get displayed in the
notification area of the system tray). These programs are running all the time
and eat up resources. The notification area of the system tray is for notifying
the user of events only. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>If you find that your
device driver's property page is unable to give you all the functionality or
configuration options that you need, this sample shows you how to write a
control panel application that might provide more extensive configuration
options and greater functionality. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>BUILDING THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>To build this sample,
enter any Microsoft® Windows® Server 2003 or Windows XP build environment and
run the command <b>build –<span class=SpellE><span class=GramE>cZ</span></span></b>
from the AC97 sample directory (parent directory). This command also builds the
AC97 WDM audio driver sample and the property page sample that are needed to
work with the control panel sample. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>The INF file AC97smpl.inf
in the AC97\driver subdirectory can be used to install the AC97 property page
sample and the AC97 WDM audio driver sample that is needed for this sample.
Simply copy the INF file, the AC97 driver binary file, and the property page
sample binary file <span class=GramE>to</span> a floppy disk and then update
the driver for the device with the one from the floppy. After updating the
driver, you can install the control panel application by simply copying the
binary file to the %SystemRoot%\system32 directory. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>SAMPLE ISSUES<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample only works
with Windows 2000 (or later) operating system due to the restrictions of the
AC97 property page sample. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>ADDITIONAL INFORMATION ABOUT THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This control panel
application simply creates a dialog and loads the AC97 property page sample
that in turn provides a property sheet to this dialog. The control panel
application then displays the dialog. Of particular interest in this sample is
the code that finds the AC97 WDM audio driver in the system because this
information needs to be passed to the AC97 property page. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>CODE TOUR<o:p></o:p></span></h3>

<h4><span style='font-family:Verdana'>File Manifest<o:p></o:p></span></h4>

<pre><u>File<span style='mso-tab-count:2'>           </span>Description</u></pre><pre><o:p>&nbsp;</o:p></pre><pre><span
class=GramE>ac97cpl.cpp</span><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>Includes all the code necessary for the sample</pre><pre><span
class=GramE>ac97cpl.def</span><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>To build the CPL file</pre><pre><span
class=GramE>ac97cpl.ico</span><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:1'>  </span>The icon</pre><pre><span class=GramE>ac97cpl.rc</span><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>  </span>Property sheet definition</pre><pre><span
class=SpellE><span class=GramE>makefile</span></span><span style='mso-spacerun:yes'>     </span><span
style='mso-tab-count:1'>  </span>Make file</pre><pre><span class=GramE>readme.htm</span><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:1'>  </span>This file</pre><pre><span class=GramE>sources</span><span style='mso-spacerun:yes'>      </span><span
style='mso-tab-count:1'>  </span>Dependency information for build utility</pre><pre><span
class=SpellE><span class=GramE>version.h</span></span><span style='mso-spacerun:yes'>    </span><span
style='mso-tab-count:1'>  </span>Version information</pre><pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre>

<p align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:"Courier New"'><a href="#top"><span
style='font-family:Verdana'>Top of page</span></a><o:p></o:p></span></p>

<p align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:Verdana;mso-bidi-font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=800
 style='width:600.0pt;mso-cellspacing:0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:2.25pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:2.25pt'>
  <p class=MsoNormal><span style='font-size:2.0pt;mso-bidi-font-size:12.0pt'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre><pre><span
style='font-size:7.5pt;font-family:"MS Sans Serif"'><o:p>&nbsp;</o:p></span></pre>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:7.5pt;font-family:"MS Sans Serif";mso-bidi-font-family:"Courier New"'>©
2004 Microsoft Corporation</span><span style='font-size:10.0pt;font-family:
"Courier New"'><o:p></o:p></span></p>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:Verdana;mso-bidi-font-family:"Courier New"'><span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

</div>

</body>

</html>

