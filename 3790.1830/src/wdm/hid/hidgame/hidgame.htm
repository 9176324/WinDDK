<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="hidgame_files/filelist.xml">
<title>HIDGAME</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"MS Sans Serif";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"Times New Roman";
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:auto;
	mso-font-signature:0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h2
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta name=Template content="C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\html.dot">
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'
leftmargin=8>

<div class=Section1>

<h2><a name=MYSAMPLE><span style='font-family:Verdana'>HIDGAME</span></a><span
style='font-family:Verdana'> <o:p></o:p></span></h2>

<h3><span style='font-family:Verdana'>Summary<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>HidGame is the WDM/HID
minidriver for analog joysticks. This driver registers with the HID class
driver and responds to IRPs put out by HIDclass. It informs HID class about the
capabilities of the joystick and polls the joystick in response to a read
IOCTL. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>This driver is loaded in
reponse to a &quot;New Hardware Found&quot; Plug and Play (PnP) event, and
consequently must have an entry in an .inf file that binds a PnP hardware ID to
this driver. Gameport joysticks are not true PnP devices, so the user (through
the GameControllers Control Panel) informs the system about a joystick attached
to the gameport. An example of how a new joystick type can be created is
provided in the accompanying .inf file. Once a user selects a joystick and
gameport, the GameControllers CPL sends an IOCTL to the gameport bus driver
(GameEnum), specifying the number of Axis / Buttons and a PnPHardware ID for
the joystick. The Gameport Bus informs PnP of a new device arrival. PnP
searches the system for a match for the hardwareID and loads the appropriate
driver. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>BUILDING THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>Use standard Windows
NT®/Windows® 2000 build tools. In the hidgame directory, type <b>build</b>. The
build script will generate the driver Hidgame.sys <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>TOOLS<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>You can test your driver
using the the following apps/tools. <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
Verdana'>·</span><span style='font-size:10.0pt;font-family:Verdana'><span
style='mso-spacerun:yes'>  </span><b>Game Controllers Control panel</b> from
the Standard Control panel<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
Verdana'>·</span><span style='font-size:10.0pt;font-family:Verdana'><span
style='mso-spacerun:yes'>  </span><b>Diquick.exe</b> (from the IDW directory) <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
Verdana'>·</span><span style='font-size:10.0pt;font-family:Verdana'><span
style='mso-spacerun:yes'>  </span><b>Shipping Microsoft DirectX games</b> <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>RESOURCES<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'><a
href="http://www.usb.org/">Universal Serial Bus</a> HID Usage Tables, Version
1.0, USB Implementers Forum. <o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>CODE TOUR<o:p></o:p></span></h3>

<h4><span style='font-family:Verdana'>File Manifest<o:p></o:p></span></h4>

<pre><span style='font-family:Courier'><o:p>&nbsp;</o:p></span></pre><pre><u><span
style='font-family:Courier'>Files<span style='mso-spacerun:yes'>         </span>Description</span></u><span
style='font-family:Courier'><o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Hidgame.htm<span style='mso-spacerun:yes'>     </span>The documentation for this sample (this file)<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Sources<span style='mso-spacerun:yes'>         </span>The generic file for building the code sample<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Makefile<span style='mso-spacerun:yes'>        </span>Used as part of the build process<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>OEMsetup.inf<span style='mso-spacerun:yes'>    </span>The .inf file for installing the code sample<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>HidGame.c<span style='mso-spacerun:yes'>       </span>DriverEntry, CreateClose, AddDevice and Unload routines<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>PnP.c<span style='mso-spacerun:yes'>           </span>Support routines for PnP IOCTLs<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>RemLock.c<span style='mso-spacerun:yes'>       </span>Support routines to enhance checking for removal locking<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Ioctl.c<span style='mso-spacerun:yes'>         </span>Support routines for Non PnP IOCTLs ( read/Device descriptor/Device Attributes, and so on)<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>HidJoy.c<span style='mso-spacerun:yes'>        </span>Support routines to configure the joystick<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Poll.c<span style='mso-spacerun:yes'>          </span>Support routine for analog joystick polling<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>i386\timing.c<span style='mso-spacerun:yes'>   </span>Support routines to use x86 time stamp counter<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Hidgame.h<span style='mso-spacerun:yes'>       </span>Common include file<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Debug.h<span style='mso-spacerun:yes'>         </span>Definitions to aid debugging<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Analog.h<span style='mso-spacerun:yes'>        </span>Definitions specific to analog joystick devices<o:p></o:p></span></pre><pre><span
style='font-family:Courier'>Hidgame.rtf<span style='mso-spacerun:yes'>     </span>Autodoc doumentation for Hidgame<o:p></o:p></span></pre><pre><span
style='font-family:Verdana'> <o:p></o:p></span></pre>

<h4><span style='font-family:Verdana'>Programming Tour<o:p></o:p></span></h4>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample has embedded
comments in the source code. The AutoDoc utility was used to generate the
following <a href="hidgame.rtf">AutoDoc comments RTF</a> file from the source
code. <o:p></o:p></span></p>

<p align=center style='text-align:center'><span style='font-size:10.0pt;
font-family:Verdana'><a href="#top">Top of page</a> <o:p></o:p></span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=624
 style='width:6.5in;mso-cellspacing:0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:1.5pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:1.5pt'>
  <p class=MsoNormal><span style='color:black'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<p><span style='font-size:7.5pt;font-family:"MS Sans Serif"'>© 2004 Microsoft
Corporation</span><span style='font-size:10.0pt;font-family:Verdana'> <o:p></o:p></span></p>

</div>

</body>

</html>

