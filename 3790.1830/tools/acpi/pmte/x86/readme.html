<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns="http://www.w3.org/TR/REC-html40" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word"><HEAD><TITLE>PMTE</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content=FrontPage.Editor.Document name=ProgId>
<META content="Microsoft FrontPage 5.0" name=GENERATOR>
<META content="Microsoft Word 10" name=Originator><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Stephen R. Berard</o:Author>
  <o:LastAuthor>Allen Marshall</o:LastAuthor>
  <o:Revision>10</o:Revision>
  <o:TotalTime>29</o:TotalTime>
  <o:Created>2001-12-07T00:00:00Z</o:Created>
  <o:LastSaved>2002-01-21T20:48:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>490</o:Words>
  <o:Characters>2796</o:Characters>
  <o:Company>American Power Conversion</o:Company>
  <o:Lines>23</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>3280</o:CharactersWithSpaces>
  <o:Version>10.3501</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<STYLE>@font-face {
	font-family: Wingdings;
}
@font-face {
	font-family: Verdana;
}
@font-face {
	font-family: MS Sans Serif;
}
@page Section1 {size: 8.5in 11.0in; margin: 1.0in 1.25in 1.0in 1.25in; mso-header-margin: .5in; mso-footer-margin: .5in; mso-paper-source: 0; }
P.MsoNormal {
	FONT-SIZE: 12pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in; margin-bottom:0pt
}
LI.MsoNormal {
	FONT-SIZE: 12pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in; margin-bottom:0pt
}
DIV.MsoNormal {
	FONT-SIZE: 12pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; margin-left:0in; margin-right:0in; margin-top:0in; margin-bottom:0pt
}
H2 {
	FONT-WEIGHT: bold; FONT-SIZE: 18pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-outline-level: 2
}
H3 {
	FONT-WEIGHT: bold; FONT-SIZE: 13.5pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto; mso-outline-level: 3
}
A:link {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlink {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
A:visited {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
SPAN.MsoHyperlinkFollowed {
	COLOR: blue; TEXT-DECORATION: underline; text-underline: single
}
P {
	FONT-SIZE: 12pt; MARGIN-LEFT: 0in; MARGIN-RIGHT: 0in; FONT-FAMILY: "Times New Roman"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto
}
SPAN.SpellE {
	mso-style-name: ""; mso-spl-e: yes
}
SPAN.GramE {
	mso-style-name: ""; mso-gram-e: yes
}
DIV.Section1 {
	page: Section1
}
OL {
	MARGIN-BOTTOM: 0in
}
UL {
	MARGIN-BOTTOM: 0in
}
</STYLE>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman"}
</style>
<![endif]-->
<META content="Stephen R. Berard" name=Author></HEAD>
<BODY lang=EN-US style="tab-interval: .5in" vLink=blue link=blue>
<DIV class=Section1>
<H2><SPAN style="FONT-FAMILY: Verdana"><o:p>Stress - </o:p></SPAN><SPAN style="FONT-FAMILY: Verdana"><o:p>PMTE Power Management Test Shell</o:p></SPAN></H2>
<H3><SPAN style="FONT-FAMILY: Verdana">SUMMARY<o:p></o:p></SPAN></H3>
<P><font size="2"><span style="font-family: Verdana">PMTE is an ACPI stress 
tool.&nbsp; PMTE includes a suite of power management stress 
  tests  designed to exercise each ACPI sleep state supported by a system, and each 
device power state supported by individual devices.&nbsp; Prior to entering and 
  after resuming from each sleep cycle, the devices in the system are tested for functionality 
  using Win32 interfaces or other methods.&nbsp; Examples include accessing 
files on the 
  system disk or pinging other machines on the network.&nbsp; During  testing, if 
  a device node fails a test, hangs, or otherwise stops working, PMTE will break into the attached kernel debugger 
to allow the issue to be debugged.&nbsp; PMTE should be run with a kernel debugger attached 
to the system and debugging enabled.&nbsp; If the kernel debugger is not 
enabled, PMTE will throw an access violation (AV) when it cannot communicate 
with a device.&nbsp; Several scripts are supplied to allow tests to be repeated 
automatically, as many times as you specify.</span></font></P>
<blockquote>
<P><font size="2"><span style="font-family: Verdana"><b>Note:</b> ACPI Stress works only with Windows 2000, Windows XP, 
and Windows Server 2003.</span></font></P>
</blockquote>
<h3><span style="font-family: Verdana">Devices Supported</span></h3>
<P><font size="2"><span style="font-family: Verdana">PMTE tests the following 
device types.</span></font></P>
<ul>
  <li><font size="2"><span style="font-family: Verdana">Disks</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">CD-ROM</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Floppy</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Sound</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">NET</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">IRDA</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Serial (with loop back)</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Modems</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Parallel port</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Video</span></font></li>
</ul>
  <h3><span style="font-family: Verdana">Running ACPI Stress</span></h3>
  <p><span style="font-family: Verdana"><font size="2">There are three methods 
  available to run PMTE; using the batch file <i>pmteauto.bat,</i> running <i>pmte.exe</i> 
  and selecting test options, or running <i>pmte.exe </i>from the command line, 
  specifying one of the included scripts and available command line options.</font></span></p>
  <h3><span style="font-family: Verdana">Using the Batch File <i>pmteauto.bat</i></span></h3>
  <p><font size="2"><span style="font-family: Verdana">This method is designed to automate 
  running PMTE.&nbsp; This option will 
  test every device on the system while cycling through all supported system 
  sleeps states.&nbsp; After it has tested every device and every supported 
  sleep state once, it then will repeat this test 99 consecutive times.</span></font></p>
  <h3><span style="font-family: Verdana">Running <i>pmte.exe</i></span></h3>
  <p><span style="font-family: Verdana"><font size="2">This method  allows you to have full control over how PMTE 
  executes.&nbsp; Running <i>pmte.exe</i> will present you with a dialog box 
  containing three tabs labeled <b>Device to Test</b>, <b>Script Run</b>, 
  and <b>Advanced</b>.</font></span></p>
  <p><span style="font-family: Verdana"><font size="2">The <b>Device to Test</b> 
  tab allows selection of the devices to be tested.&nbsp; To exclude testing a 
  specific device simply deselect the device in this tab.</font></span></p>
  <p><span style="font-family: Verdana"><font size="2">The <b>Script Run</b> tab 
  allows selection of available scripts.&nbsp; You can then elect how long you 
  want PMTE to run by specifying the test duration in days, 
  hours, and minutes, the number of days and a specific time of day, or the 
  number of test cycles.&nbsp; You may also specify which system sleep states 
  to exclude.&nbsp; </font> </span></p>
  <p><span style="font-family: Verdana"><font size="2">The <b>Advanced</b> tab 
  allows configuration of the following settings.</font></span></p>
  <ul>
    <li><span style="font-family: Verdana"><font size="2">Select a hard disk 
    spin down time.</font></span></li>
    <li><span style="font-family: Verdana"><font size="2">Use the reset  after hibernate 
    option.&nbsp; This helps to automate hibernate testing on machines that don’t support 
    wake from S4 via the RTC.</font></span></li>
    <li><span style="font-family: Verdana"><font size="2">Ignore any reported RTC capabilities.</font></span></li>
    <li><span style="font-family: Verdana"><font size="2">Specify which network share to 
    use for testing network I/O.&nbsp; This allows you  to make sure the system can reach a share that exists.&nbsp; If a 
  network share is not specified, then a <i>net view</i> command is done, and any systems found 
  are pinged to test network functionality.</font></span></li>
    <li><span style="font-family: Verdana"><font size="2">Specify what PMTE will do 
    should a test instance hang.&nbsp; 
  You may elect to have PMTE break into the debugger,  terminate the test process, or just 
  ignore the failing test.</font></span></li>
</ul>
<h3><span style="font-family: Verdana">Running a Script from the Command Line</span></h3>
<P><font size="2"><span style="font-family: Verdana">To run a PMTE script, enter 
the following command:</span></font></P>
<blockquote>
<P><font face="Courier New" size="2">pmte /rs: &lt;scriptName&gt; &lt;NumberOfTimes&gt;</font></P>
</blockquote>
<h3><span style="font-family: Verdana"><font size="2">Excluding Specific Device Types</font></span></h3>
<P><font size="2"><span style="font-family: Verdana">To exclude one or more 
devices types, you may use the /sdt: (Skip Device Type) switch for each device 
type you want to omit.</span></font></P>
<P><font size="2"><span style="font-family: Verdana">For example, to omit the 
serial port and Floppy devices types, enter the command below.</span></font></P>
<blockquote>
<P><font size="2" face="Courier New">pmte /sdt: com /sdt: bootfloppy</font></P>
</blockquote>
<P><font size="2"><span style="font-family: Verdana">It is usually a good idea 
to skip the bootfloppy because hibernate will probably not be automated.</span></font></P>
<P><font size="2"><span style="font-family: Verdana">Devices that can be 
excluded by including the /sdt command line switch are:</span></font></P>
<ul>
  <li><font size="2"><span style="font-family: Verdana">COM</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">Floppy</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">NET</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">IRDA</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">DISK</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">SOUND</span></font></li>
  <li><font size="2"><span style="font-family: Verdana">VIDEO</span></font></li>
</ul>
<h3><span style="font-family: Verdana"><font size="2">Other Command Line Switches</font></span></h3>
<P><font size="2"><span style="font-family: Verdana">/QOS:</span></font></P>
<blockquote>
<P><font size="2"><span style="font-family: Verdana">Causes PMTE to exit when 
testing completes, if all tests have passed.</span></font></P>
</blockquote>
<P><font size="2"><span style="font-family: Verdana">/LOG: [log file name]</span></font></P>
<blockquote>
<P><font size="2"><span style="font-family: Verdana">The default log file name 
is pmte.log.&nbsp; This switch allows a different log filename to be specified.</span></font></P>
</blockquote>
<P style="TEXT-ALIGN: center" align=center><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><a href="#top">Top of page</a></SPAN> <SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P>
<TABLE class=MsoNormalTable 
style="WIDTH: 6.5in; mso-cellspacing: 0in; mso-padding-alt: 0in 5.4pt 0in 5.4pt" 
cellSpacing=0 cellPadding=0 width=624 border=0>
  <TBODY>
  <TR style="HEIGHT: 1.5pt; mso-yfti-irow: 0; mso-yfti-lastrow: yes">
    <TD 
    style="PADDING-RIGHT: 0.75pt; PADDING-LEFT: 0.75pt; BACKGROUND: aqua; PADDING-BOTTOM: 0.75pt; PADDING-TOP: 0.75pt; HEIGHT: 1.5pt; x-background-x-position: 0%; x-background-y-position: 0%">
      <P class=MsoNormal align="center"><SPAN 
      style="FONT-SIZE: 2pt"><o:p>&nbsp;</o:p></SPAN></P></TD></TR></TBODY></TABLE>
<P><SPAN style="FONT-SIZE: 7.5pt; FONT-FAMILY: 'MS Sans Serif'">© Microsoft 
Corporation 2002</SPAN></P></DIV></BODY></HTML>