<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 12">
<meta name=Originator content="Microsoft Word 12">
<link rel=File-List href="ReadMe_smscir_files/filelist.xml">
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceType"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceName"/>
<!--[if gte mso 9]><xml>
 <o:OfficeDocumentSettings>
  <o:RemovePersonalInformation/>
  <o:RemoveDateAndTime/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="ReadMe_smscir_files/themedata.thmx">
<link rel=colorSchemeMapping href="ReadMe_smscir_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>130</w:Zoom>
  <w:DisplayBackgroundShape/>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="--"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" LatentStyleCount="267">
  <w:LsdException Locked="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="99" Name="No List"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Vrinda;
	panose-1:1 1 6 0 1 1 1 1 1 1;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:65539 0 0 0 1 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073741899 0 0 159 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1593833729 1073750107 16 0 415 0;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610611985 1073750091 0 0 159 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#365F91;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:0pt;
	font-weight:bold;}
h2
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	font-weight:bold;}
h3
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	font-weight:bold;}
h4
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	font-weight:bold;}
h5
	{mso-style-noshow:yes;
	mso-style-qformat:yes;
	mso-style-link:"Heading 5 Char";
	mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#243F60;
	mso-themecolor:accent1;
	mso-themeshade:127;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-qformat:yes;
	mso-style-link:"Heading 6 Char";
	mso-style-next:Normal;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#243F60;
	mso-themecolor:accent1;
	mso-themeshade:127;
	font-weight:normal;
	font-style:italic;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-unhide:no;
	mso-style-link:"Header Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-unhide:no;
	mso-style-link:"Footer Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.25in right 6.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-unhide:no;
	mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{mso-style-unhide:no;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-unhide:no;
	color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-style-unhide:no;
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
pre
	{mso-style-unhide:no;
	mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	mso-fareast-font-family:"Times New Roman";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#365F91;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#4F81BD;
	mso-themecolor:accent1;
	font-weight:bold;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-noshow:yes;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 5";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#243F60;
	mso-themecolor:accent1;
	mso-themeshade:127;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-noshow:yes;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 6";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#243F60;
	mso-themecolor:accent1;
	mso-themeshade:127;
	font-style:italic;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"HTML Preformatted";
	font-family:Consolas;
	mso-ascii-font-family:Consolas;
	mso-hansi-font-family:Consolas;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Header;
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Footer;
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Body Text";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:10.0pt;
	mso-ansi-font-size:10.0pt;
	mso-bidi-font-size:10.0pt;}
 /* Page Definitions */
 @page
	{mso-footnote-separator:url("ReadMe_smscir_files/header.htm") fs;
	mso-footnote-continuation-separator:url("ReadMe_smscir_files/header.htm") fcs;
	mso-endnote-separator:url("ReadMe_smscir_files/header.htm") es;
	mso-endnote-continuation-separator:url("ReadMe_smscir_files/header.htm") ecs;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-header:url("ReadMe_smscir_files/header.htm") eh1;
	mso-header:url("ReadMe_smscir_files/header.htm") h1;
	mso-even-footer:url("ReadMe_smscir_files/header.htm") ef1;
	mso-footer:url("ReadMe_smscir_files/header.htm") f1;
	mso-first-header:url("ReadMe_smscir_files/header.htm") fh1;
	mso-first-footer:url("ReadMe_smscir_files/header.htm") ff1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:37244311;
	mso-list-type:hybrid;
	mso-list-template-ids:-912994926 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l0:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1
	{mso-list-id:173227786;
	mso-list-type:hybrid;
	mso-list-template-ids:941510228 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l1:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2
	{mso-list-id:1265459751;
	mso-list-type:hybrid;
	mso-list-template-ids:1966535758 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l2:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3
	{mso-list-id:1365860245;
	mso-list-type:hybrid;
	mso-list-template-ids:-2140773054 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l3:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l3:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:2070879101;
	mso-list-type:hybrid;
	mso-list-template-ids:-1526928338 67698703 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level3
	{mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level4
	{mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level5
	{mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level6
	{mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level7
	{mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level8
	{mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4:level9
	{mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="6146"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<h2><span style='mso-fareast-font-family:"Times New Roman"'>SMSCIR: Windows
Vista with <st1:place w:st="on"><st1:PlaceName w:st="on">Media</st1:PlaceName> <st1:PlaceType
 w:st="on">Center</st1:PlaceType></st1:place> Consumer IR Receiver Sample
Driver <o:p></o:p></span></h2>

<h3>SUMMARY</h3>

<p class=MsoNormal><a name="OLE_LINK2"></a><a name="OLE_LINK1"><span
style='mso-bookmark:OLE_LINK2'>The SMSCIR sample implements a driver for a
Consumer IR receiver for Windows Vista with Media Center.<span
style='mso-spacerun:yes'>  </span>This driver works with the SMSC SIO1049 SuperIO
chip and is intended to show how to write a Consumer IR Receiver/Transceiver
driver for Windows Vista with Media Center.<span style='mso-spacerun:yes'> 
</span>This sample driver works with the CirClass.sys driver and implements IR
input, IR learning, and IR blasting.<span style='mso-spacerun:yes'>  </span>For
IR input, it works with all </span></a><st1:place w:st="on"><st1:PlaceName
 w:st="on"><span style='mso-bookmark:OLE_LINK2'><span style='mso-bookmark:OLE_LINK1'>Media</span></span></st1:PlaceName><span
 style='mso-bookmark:OLE_LINK2'><span style='mso-bookmark:OLE_LINK1'> <st1:PlaceType
 w:st="on">Center</st1:PlaceType></span></span></st1:place><span
style='mso-bookmark:OLE_LINK2'><span style='mso-bookmark:OLE_LINK1'> compatible
IR Remote Controls.</span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK2'><span style='mso-bookmark:
OLE_LINK1'><o:p>&nbsp;</o:p></span></span></p>

<p class=MsoNormal><span style='mso-bookmark:OLE_LINK2'><span style='mso-bookmark:
OLE_LINK1'>In order to run this driver, you need a PC with an SIO1049 chip, or
an SIO1049 development board which plugs into an LPC or a TPM slot.<span
style='mso-spacerun:yes'>  </span>Details on the SIO1049 chip are available
from SMSC.<span style='mso-spacerun:yes'>  </span>Additionally, BIOS
modifications may be necessary to use the SIO1049 development board.<span
style='mso-spacerun:yes'>  </span>SMSC offers a SIO1049 BIOS Porting Guide to
assist you with this.<span style='mso-spacerun:yes'>  </span></span></span></p>

<h3>BUILDING THE SAMPLE<span style='font-size:10.0pt;font-family:"Verdana","sans-serif";
mso-bidi-font-family:Vrinda'><o:p></o:p></span></h3>

<p class=MsoNormal>Build the sample by typing build -cez in either the standard
checked or free WDK build environment. A successful build produces smscir.sys.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.0pt'>The sample works on
32-bit x86 and 64-bit amd64 platforms running Vista RC-1 or higher.<span
style='mso-spacerun:yes'>  </span>It does not work on Windows XP, Windows 2000,
Windows Server 2003, or any older version of Windows.<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-size:10.0pt'>The sample uses the
circoinst.dll CoInstaller to install the Consumer IR class drivers.<span
style='mso-spacerun:yes'>  </span>These class drivers are necessary for normal
operation of this driver.<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h4>Installation instructions:</h4>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Copy smscir.inf to a directory </p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Make a subdirectory named “amd64” or “i386” depending
on the platform you are using.<span style='mso-spacerun:yes'>  </span>Copy
smscir.sys into that directory.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Copy circoinst.dll into the same directory as
smscir.sys.<span style='mso-spacerun:yes'>  </span>This can be found in or
under %windir%\system32\.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Right click on “My Computer” and select “Manage”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Select “Device Manager”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Look for the Unknown Device with the hardware ID of
“ACPI\SMCB0C0”</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Right click on this device to install the driver
software.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Locate smscir.inf</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l4 level1 lfo2'><![if !supportLists]><span
style='mso-list:Ignore'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Follow the on screen instructions </p>

<h3>RUNNING THE SAMPLE<span style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></h3>

<p class=MsoNormal>Once installation is complete, the driver can be tested
using a Media Center compatible remote control for input.<span
style='mso-spacerun:yes'>  </span>This can also be tested by setting up a
Digital Set Top Box as a video source for <st1:place w:st="on"><st1:PlaceName
 w:st="on">Windows</st1:PlaceName> <st1:PlaceName w:st="on">Media</st1:PlaceName>
 <st1:PlaceType w:st="on">Center</st1:PlaceType></st1:place>.<span
style='mso-spacerun:yes'>  </span>There are two test programs available to
exercise the sample.<span style='mso-spacerun:yes'>  </span>One is called
“cirtest.exe” and the other is called “IrReceiverTest.exe”.<span
style='mso-spacerun:yes'>  </span>Support for these tools can be obtained
through the <a href="mailto:IrRecvr@microsoft.com"><span style='font-size:10.0pt;
font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'>IrRecvr@microsoft.com</span></a>
email alias.<span style='mso-spacerun:yes'>  </span></p>

<h3>DOCUMENTATION<span style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:"Verdana","sans-serif";mso-bidi-font-family:
Vrinda'>Complete documentation for writing a Media Center port driver is
available in a document titled <i style='mso-bidi-font-style:normal'>ImplementingAnInfraredRemoteControlPortDriver.rtf<o:p></o:p></i></span></p>

<h3>CODE TOUR<span style='mso-bidi-font-size:10.0pt'><o:p></o:p></span></h3>

<h4>The Sample CIR Port Driver</h4>

<p class=MsoNormal>This section contains a module-by-module tour of a sample
CIR Port Driver – the driver for the SMSC SIO1049 chip. The complete source
code for this driver, <b style='mso-bidi-font-weight:normal'>smscir</b>,
appears in the Windows Driver Kit for <st1:place w:st="on">Vista</st1:place>.</p>

<h4>General Comments</h4>

<p class=MsoNormal>The <b style='mso-bidi-font-weight:normal'>smscir</b> driver
supports the CIR receiver and transmitter that’s part of the SMSC SIO1049
chip.<span style='mso-spacerun:yes'>  </span>The device and driver support both
transmitting and receiving, and thus support IR Learning and blasting.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The driver is written in C, using the Windows Driver
Foundation (WDF) Kernel Mode Driver Framework (KMDF). </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>This driver was specifically designed to be both a working
driver for the SIO1049 and an example driver for the WDK.<span
style='mso-spacerun:yes'>  </span>Thus, the driver contains extensive comments
and provisions for tracing.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Tracing is accomplished in the driver using the <b
style='mso-bidi-font-weight:normal'>SmscIrTracePrint</b> macro, which is
defined in the file <b style='mso-bidi-font-weight:normal'>smscir.h</b>. The
driver supports two alternative methods of tracing, and the method the driver
uses depends on how it is built.<span style='mso-spacerun:yes'>  </span>Those
two methods are:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Event Tracing for Windows (ETW), via Windows
Pre-Processor (WPP) tracing.<span style='mso-spacerun:yes'>  </span>When WPP
tracing support is enabled, the driver will output its trace messages via
ETW.<span style='mso-spacerun:yes'>  </span>These trace messages can be viewed
in real time using a utility such as TraceView (available in the Windows DDK or
Windows Vista WDK), or saved to a file for later review.<span
style='mso-spacerun:yes'>  </span>WPP tracing is enabled in the driver by
defining the value WPP_TRACING when the driver is built.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l3 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Tracing via DbgPrint.<span
style='mso-spacerun:yes'>  </span>In this case, output is written to the kernel
debugger.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Note that the two tracing methods used in the driver are
mutually exclusive:<span style='mso-spacerun:yes'>  </span>Only one may be
enabled at a time. By default, the driver builds with WPP tracing enabled in
both the free and checked versions of the driver.<span
style='mso-spacerun:yes'>  </span>Regardless of the tracing method chosen,
trace output can be optionally enabled based on the driver code path and/or the
“severity level” of the message.<span style='mso-spacerun:yes'>  </span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<h4>Driver Source Code Modules</h4>

<p class=MsoNormal>The driver uses a single header file, named <b
style='mso-bidi-font-weight:normal'>smscir.h</b>.<span
style='mso-spacerun:yes'>  </span>This file contains definitions of the
driver’s common data structures, device registers, tuning parameters, and the
inlined functions that perform device access (such as WRITE_TRANSMIT_UCHAR). <span
style='mso-spacerun:yes'> </span>The header file also contains many useful
comments.<span style='mso-spacerun:yes'>  </span>We urge you to review this
header file before reading the other driver source code files.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>In addition to the header file previously described, the
modules that comprise the driver are as follows:</p>

<p class=MsoNormal><span style='font-family:"Verdana","sans-serif";mso-bidi-font-family:
Vrinda'><o:p>&nbsp;</o:p></span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>smscir.c</b>
– This module contains the driver’s <b style='mso-bidi-font-weight:normal'>DriverEntry</b>
and unload routines.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>pnp.c</b>
– This file contains the routines related to the smscir driver’s handling of
PnP and power state transitions.<span style='mso-spacerun:yes'>  </span>Among
other functions included in this module are the driver’s implementations of the
<b style='mso-bidi-font-weight:normal'>EvtDeviceAdd</b>, <b style='mso-bidi-font-weight:
normal'>EvtDevicePrepareHardware</b>, <b style='mso-bidi-font-weight:normal'>EvtDeviceD0Entry</b>
event processing callbacks.<span style='mso-spacerun:yes'>  </span>Note that
the driver also provides a handler for the <b style='mso-bidi-font-weight:normal'>EvtIoStop</b>
event.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>io.c </b>–
The driver’s request processing callbacks, including file-related callbacks,
are located in this module.<span style='mso-spacerun:yes'>  </span>These
functions manage receiving, processing, and canceling I/O the IOCTLs sent to
smscir by the CIR Class driver.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>wake.c </b>–
This module contains the functions that arm the CIR device for wake, and
detect, when a wake-up event occurs, whether it was the CIR device that woke
the system.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>isr.c</b>
– This file contains the driver’s <b style='mso-bidi-font-weight:normal'>EvtInterruptIsr</b>
event processing callback, as well as other functions related to enabling,
disabling, and processing hardware interrupts.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l0 level1 lfo6'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><b style='mso-bidi-font-weight:normal'>dpc.c</b>
– This module contains the driver’s code for the <b style='mso-bidi-font-weight:
normal'>EvtInterruptDpc</b> event processing callback.<span
style='mso-spacerun:yes'>  </span>It also contains code for converting received
data from internal SMSC format to the standard Run Length Coding (RLC) format
expected by the class driver.<span style='mso-spacerun:yes'>  </span>This
encoding is performed using the tables contained in the file <b
style='mso-bidi-font-weight:normal'>runtables.c</b>.</p>

<h4>smscir.c – DriverEntry</h4>

<p class=MsoNormal>The code in <b style='mso-bidi-font-weight:normal'>DriverEntry</b>
is typical of that for any KMDF driver. The only thing that’s even slightly
unusual is that the driver copies the registry path for later use during the
driver’s EvtDeviceAdd processing (see the reference to the registry path in the
file wake.c, routine <b style='mso-bidi-font-weight:normal'>SmscIrSetWakeKeyInfo</b>).</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The code for the <b style='mso-bidi-font-weight:normal'>DriverEntry</b>
function demonstrates a few of the implementation conventions used throughout
the <b style='mso-bidi-font-weight:normal'>smscir</b> driver. For example, note
the use of the <b style='mso-bidi-font-weight:normal'>SmscIrTracePrint</b>
macro for logging information.<span style='mso-spacerun:yes'>  </span>The first
two calls to this macro specify TRACE_LEVEL_VERBOSE, indicating that the output
message will be produced only if least stringent output filter is applied.<span
style='mso-spacerun:yes'>  </span>The next call to <b style='mso-bidi-font-weight:
normal'>SmscIrTracePrint </b>appears in the error handling path after the
driver calls WdfDriverCreate.<span style='mso-spacerun:yes'>  </span>Note that
in this case, the macro is called with the trace level set to
TRACE_LEVEL_ERROR.<span style='mso-spacerun:yes'>  </span>This will cause this
message to be logged even when tracing for non-error cases is disabled.</p>

<h4>pnp.c – PnP and Power Event Processing Callbacks</h4>

<p class=MsoNormal>The <b style='mso-bidi-font-weight:normal'>SmscIrEvtDeviceAdd</b>
function is the driver’s implementation of the <b style='mso-bidi-font-weight:
normal'>EvtDeviceAdd</b> event processing callback routine.<span
style='mso-spacerun:yes'>  </span>Most of the code in this routine is pretty
much standard for any KMDF driver. You might want to pay particular attention
to the following points:</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l1 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Because this driver handles its own
serialization and does not rely upon WDF to provide request synchronization,
the driver sets its synchronization scope to <b style='mso-bidi-font-weight:
normal'>WdfSynchronizationScopeNone.</b></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l1 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>For maintenance clarity and ease of debugging,
the driver specifies file object callbacks for Create and Close requests.<span
style='mso-spacerun:yes'>  </span>These callbacks allow only a single open
instance per device. In place of providing these callbacks, the driver could
have provided no Create or Close callbacks and called <b style='mso-bidi-font-weight:
normal'>WdfDeviceInitSetExclusive</b>, which has the effect of allowing only a
single open instance per device.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l1 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The driver creates a periodic timer that will be
used as a “dead man timer.”<span style='mso-spacerun:yes'>  </span>The driver uses
this timer to ensure that transmit (blasting) requests do not hang -- That is,
if there’s a transmit operation in progress and the device hasn’t completed the
request within one second, the driver will know that the transmitter hardware
is likely hung and performs a reset. See the function <b style='mso-bidi-font-weight:
normal'>SmscIrEvtDeadManTimerForTransmit</b> for the details of how the
transmit deadman timer is handled.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l1 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>The only request types processed by the driver
are that Device I/O Control (IOCTL) requests.<span style='mso-spacerun:yes'> 
</span>To handling incoming requests, the driver creates four request
queues.<span style='mso-spacerun:yes'>  </span>Requests from the CIR Class
driver arrive on the default queue, which is configured for parallel
dispatching.<span style='mso-spacerun:yes'>  </span>The I/O event processing
callback for IOCTLs arriving on this queue is <b style='mso-bidi-font-weight:
normal'>SmscIrEvtIoDeviceControl </b>(located in the module io.c).<span
style='mso-spacerun:yes'>  </span>As requests arrive on the default queue, the
driver dispatches them to one of three other queues that the driver creates
during <b style='mso-bidi-font-weight:normal'>EvtDeviceAdd</b> processing.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l1 level1 lfo8'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-weight:bold'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Before leaving its <b style='mso-bidi-font-weight:
normal'>EvtDeviceAdd</b> processing callback, the smscir driver creates a
device interface using the device interface class GUI
GUID_DEVINTERFACE_IRPORT.<span style='mso-spacerun:yes'>  </span>KMDF will
automatically enable the interface when the device enters its “working”
state.<span style='mso-spacerun:yes'>  </span>The CIR Class driver is notified
whenever an interface with this device interface class is enabled, and responds
by sending an IOCTL_IR_HANDSHAKE request to the device associated with the
newly enabled interface.<span style='mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The driver’s <b style='mso-bidi-font-weight:normal'>EvtDevicePrepareHardware</b>
and <b style='mso-bidi-font-weight:normal'>EvtDeviceReleaseHardware</b> event
processing callbacks located in this module are <b style='mso-bidi-font-weight:
normal'>SmscIrEvtDevicePrepareHardware</b> and <b style='mso-bidi-font-weight:
normal'>SmscIrEvtDeviceReleaseHardware</b>, respectively.<span
style='mso-spacerun:yes'>  </span>These functions are specific to the SMSC
SIO1049 hardware.</p>

<h4>io.c – Request Processing</h4>

<p class=MsoNormal>The key function within this module is <b style='mso-bidi-font-weight:
normal'>SmscIrEvtIoDeviceControl</b>, which is the event processing callback
function for the driver’s default queue.<span style='mso-spacerun:yes'> 
</span>It is important to note that because the default queue is configured for
parallel dispatching, this function can be simultaneously active in multiple
threads.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Processing within the <b style='mso-bidi-font-weight:normal'>SmscIrEvtDeviceControl</b>
function starts by immediately passing any incoming IOCT_IR_RECEIVE or
IOCTL_IR_PRIORITY_RECEIVE requests to their dedicated processing functions
(IrReceive and IrPriorityReceive, respectively).<span
style='mso-spacerun:yes'>  </span>If the incoming request is other than one of
these two request types, the driver forwards it to a serial queue for further
processing.<span style='mso-spacerun:yes'>  </span>The effect of these actions
is that the driver is capable of handling receive, priority receive, and one
other request simultaneously.</p>

<h4>Receive Processing</h4>

<p class=MsoNormal>Within the <b style='mso-bidi-font-weight:normal'>IrReceive</b>
function, the driver validates the incoming request.<span
style='mso-spacerun:yes'>  </span>If the request is valid, the drivers acquires
the receive list lock.<span style='mso-spacerun:yes'>  </span>This lock
serializes access to the list of standard (not priority) receive requests.<span
style='mso-spacerun:yes'>  </span>With the receive list lock held, the driver
checks to see if a standard receive is currently in progress.<span
style='mso-spacerun:yes'>  </span>If it is, the driver forwards the request to
its pending receive queue.<span style='mso-spacerun:yes'>  </span>If a receive
request is not already in progress, and the driver is not in priority receive
mode (as a result of previously having processed an <span style='mso-bidi-font-weight:
bold'>IOCTL_IR_ENTER_PRIORITY_RECEIVE request)</span>, the driver calls <b>SmscIrDequeueRLCData
</b><span style='mso-bidi-font-weight:bold'>to a</span>ttempt to satisfy the
incoming receive with RLC data from its buffer of previously received data
(data structure name SMSCIR_RLC_RECEIVER).<span style='mso-spacerun:yes'> 
</span>If the driver’s SMSCIR_RLC_RECEIVER contains enough data to satisfy the
request, it is immediately completed.<span style='mso-spacerun:yes'> 
</span>Otherwise, the request is marked cancellable and queued.<span
style='mso-spacerun:yes'>  </span>The request will remain queued until
sufficient CIR data arrives as signaled to the driver by a receive
interrupt.<span style='mso-spacerun:yes'>  </span>See the description of
receive processing later in the section on the module dpc.c.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>The <b style='mso-bidi-font-weight:normal'>IrPriorityReceive</b>
function is almost identical to the <b style='mso-bidi-font-weight:normal'>IrReceive</b>
function.<span style='mso-spacerun:yes'>  </span>The major difference is that
at the start of IrPriorityReceive, if the driver is not current in priority
receive mode (as a result of previously having processed an <span
style='mso-bidi-font-weight:bold'>IOCTL_IR_ENTER_PRIORITY_RECEIVE request)</span>,
the driver completes the incoming IOCTL_IR_PRIORITY_RECEIVE request with
STATUS_INVALID_DEVICE_STATE.</p>

<h4>Processing Other (non-Receive) Request Types</h4>

<p class=MsoNormal>As previously notes, all request types other than
IOCTL_IR_RECEIVE and IOCTL_IR_PRIORITY_RECEIVE are handled via the driver’s
serial processing queue. When IOCTL requests are present on the driver’s serial
processing queue, KMDF calls the driver’s <b>SmscIrEvtIoDeviceControlSerial </b><span
style='mso-bidi-font-weight:bold'>function to processes these requests one
request at a time.<span style='mso-spacerun:yes'>  </span>When <b>SmscIrEvtIoDeviceControlSerial
</b>completes a request and returns, KMDF will call the function again if there
are any requests remaining on the queue.<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>The most interesting of the serially processed requests is
IOCTL_IR_TRANSMIT.<span style='mso-spacerun:yes'>  </span>These requests are
handled by the smscir driver’s <b style='mso-bidi-font-weight:normal'>IrTransmit</b>
function.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'>IrTransmit</b> starts
by validating the received request.<span style='mso-spacerun:yes'>  </span>If
the request is not valid, it is completed with an appropriate error
status.<span style='mso-spacerun:yes'>  </span>Otherwise, the SIO1049 device is
immediately programmed with the selected carrier and emitter mask.<span
style='mso-spacerun:yes'>  </span>This can be done at this point because only
one transmit at a time can be in progress, given that transmit requests are
processed using a serial queue. </p>

<p class=MsoNormal><span style='font-family:"Verdana","sans-serif";mso-bidi-font-family:
Vrinda;mso-bidi-font-weight:bold'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal>After the SIO1049 has been programmed with the desired
carrier and emitter mask, the driver loops over the data to be transmitted
converting it from RLC to SIO1049 format via the function <b style='mso-bidi-font-weight:
normal'>IrTransmitBuildFifoData </b>(which is also located in the module io.c).
<b style='mso-bidi-font-weight:normal'>IrTransmitBuildFifoData</b> allocates an
SMSCIR_TX_FIFO_DATA block from non-paged pool to hold the converted data and
performs the conversion, ensuring that the data in the packet is an integral
multiple of SMSCIR_FIFO_SIZE (which is a hardware specific requirement of the
SIO1049).<span style='mso-spacerun:yes'>  </span>After an SMSCIR_TX_FIFO_DATA
block is built, <b style='mso-bidi-font-weight:normal'>IrTransmit</b> inserts
it into the transmit data list (the <b style='mso-bidi-font-weight:normal'>TxFifoDataList</b>).<span
style='mso-spacerun:yes'>  </span>The loop completes when all data in the
arriving transmit request has been converted to SIO1049 format in
SMSCIR_TX_FIFO_DATA packets, and those packets have been placed on the transmit
data list.<span style='mso-spacerun:yes'>  </span>At this point, the transmit
request is ready to process.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>To start the actual IR blasting operation, the driver calls <b
style='mso-bidi-font-weight:normal'>SmscIrContinueBlasting</b> (located in the
module dpc.c), where SMSCIR_FIFO_SIZE bytes of data in internal format are
copied to the SIO1049’s FIFO from the first block on the transmit data list
(see the inline function <b style='mso-bidi-font-weight:normal'>WRITE_TRANSMIT_BUFFER_UCHAR</b>
in smscir.h to see how the data is actually moved to the SIO1049 FIFO).</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>As a result of the call to <b style='mso-bidi-font-weight:
normal'>SmscIrContinueBlasting</b>, the first block of IR data will be
transmitted by the device.<span style='mso-spacerun:yes'>  </span>When the
device’s transmit FIFO empties the SIO1049 generates a transmit FIFO interrupt.<span
style='mso-spacerun:yes'>  </span>The driver’s <b style='mso-bidi-font-weight:
normal'>EvtInterruptIrp</b> event processing callback function, <b
style='mso-bidi-font-weight:normal'>SmscIrEvtInterruptIsr</b>, receives the
FIFO transmit interrupt (see the function <b style='mso-bidi-font-weight:normal'>SmscIrProcessTxInterrupt</b>)
and queues a DPC callback by calling <b style='mso-bidi-font-weight:normal'>WdfInterruptQueueDpcForIsr</b>.<span
style='mso-spacerun:yes'>  </span>The driver’s DPC event processing callback
(function <b style='mso-bidi-font-weight:normal'>SmscIrEvtInterrutpDpc</b>) is
then called, and continues processing the transmit request by calling <b
style='mso-bidi-font-weight:normal'>SmscIrContinueBlasting</b>.<span
style='mso-spacerun:yes'>  </span>If the transmit request is completed, the
driver calls <b style='mso-bidi-font-weight:normal'>WdfRequestComplete.</b></p>

<h4>wake.c – Handling Wake Requests</h4>

<p class=MsoNormal>The wake module comprises almost exclusively
SIO1049-specific code for arming the device for wake (see the functions <b>SmscIrSetWakeKeyInfo
</b><span style='mso-bidi-font-weight:bold'>and</span> <b>SmscIrEvtDeviceWakeArm</b><span
style='mso-bidi-font-weight:bold'>) and for detecting if the SIO1049 device
woke the system.<o:p></o:p></span></p>

<h4>isr.c – Interrupt Service Routine</h4>

<p class=MsoNormal>This file comprises the mostly hardware-specific code for
handling interrupts and buffering data.<span style='mso-spacerun:yes'> 
</span>The main function in this module is <b style='mso-bidi-font-weight:normal'>SmscIrEvtInterruptIsr</b>,
which is the driver’s interrupt event processing callback function.<span
style='mso-spacerun:yes'>  </span>This function is call when the device
generates a hardware interrupt.<span style='mso-spacerun:yes'>  </span>Its main
job is to determine whether the interrupt pending from the device is a transmit
interrupt or a receive interrupt, and dispatch to the appropriate processing
routine.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>One general point about KMDF drivers that’s worthy of
particular note is that KMDF disconnects the driver’s interrupt event
processing callback function from the device’s interrupt vector (after calling
the driver’s Interrupt Disable event processing callback) each time the device
leaves D0 (ready) state.<span style='mso-spacerun:yes'>  </span>Because of
this, logic in the device’s interrupt event processing callback function is not
required to determine the power state of the device before interrogating its
registers.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Transmit interrupt have been briefly discussed earlier in
this document.<span style='mso-spacerun:yes'>  </span>If a transmit interrupt
is determined to be pending, the main interrupt event processing callback
function, calls the function <b style='mso-bidi-font-weight:normal'>SmscIrProcessTxInterrupt</b>.<span
style='mso-spacerun:yes'>  </span>If the reason for a transmit interrupt is
that the transmit FIFO is empty, the driver disables further transmit
interrupts and queues a DPC, where further transmit processing will take
place.<span style='mso-spacerun:yes'>  </span>Also note that this function
makes a “shadow copy” of the transmit interrupt ID register in its SMSCIR_DATA
(device context) storage location TxIntId.<span style='mso-spacerun:yes'> 
</span>The driver will use this copy in its DPC to determine if a transmit
interrupt has taken place, and not the device’s transmit interrupt ID register
which is reset by this routine.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Receive interrupt processing is much more interesting. The
driver’s main interrupt event processing callback function calls the function <b
style='mso-bidi-font-weight:normal'>SmscIrProcessRxInterrupt</b> when a receive
interrupt is found to be pending.<span style='mso-spacerun:yes'>  </span>This
function calls <b style='mso-bidi-font-weight:normal'>SmscIrEnqueueFifoBytes</b>
to copy the received bytes representing incoming IR data from the device’s FIFO
to a circular buffer located in the PDO at the vector FifoBuffer.<span
style='mso-spacerun:yes'>  </span>The data is copied within the ISR because
emptying the FIFO is a time-critical activity and the amount of data copied at
each interrupt is never large.<span style='mso-spacerun:yes'>  </span>Note,
however, that the data is copied to FifoBuffer in SMSC1049 internal format – To
minimize the time spent at DIRQL the translation to RLC format is performed in
the DPC not within the ISR.<span style='mso-spacerun:yes'>  </span>When the
device’s receive FIFO is emptied, the driver queues a DPC where the remaining
processing of the received data will be performed.</p>

<h4>dpc.c – Receive and Transmit Data Handling</h4>

<p class=MsoNormal>The driver uses a single DPC routine, named <b
style='mso-bidi-font-weight:normal'>SmscIrEvtInterruptDpc</b>.<span
style='mso-spacerun:yes'>  </span>Note that, like all such routines, this
function has been constructed to serialize its processing carefully because on
a multiprocessing system multiple instances of the DPC can be executing in
parallel.</p>

<h6><o:p>&nbsp;</o:p></h6>

<p class=MsoNormal>The function begins by determining if the driver is in
priority receive or “normal” receive mode – This defines where any newly
received data will be stored.<span style='mso-spacerun:yes'>  </span>The
function then acquires the appropriate locks: The receive list spin lock and
the transmit FIFO list lock.<span style='mso-spacerun:yes'>  </span>The driver
then loops multiple times servicing the device.<span style='mso-spacerun:yes'> 
</span>This loop is required because multiple device interrupts can result in a
single DPC invocation.<span style='mso-spacerun:yes'>  </span>For receive data,
looping ensures that the circular buffer shared between the ISR and the DPC
doesn’t overflow.<span style='mso-spacerun:yes'>  </span>For transmit data, the
loop ensures that CIR sequences longer than a SIO1049’s FIFO size are
transmitted without excessive pauses between blocks.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>For each loop in the DPC, the following logic is performed,
the driver:</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>acquires the interrupt spin lock, thereby
increasing the IRQL to DIRQL.<span style='mso-spacerun:yes'>  </span>This is
necessary to serialize access to the FifoBuffer (the circular buffer containing
receive data that is shared between the ISR and DPC).</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;mso-bidi-font-weight:bold'><span style='mso-list:Ignore'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>calls <b>SmscIrDequeueFifoData </b><span
style='mso-bidi-font-weight:bold'>(which is located in the file isr.c) to copy
the data from the FifoBuffer to an intermediate holding buffer in the DPC.<span
style='mso-spacerun:yes'>  </span>Making this intermediate copy allows the driver
to more quickly drop the interrupt spin lock, and return processing to IRQL
DISPATCH_LEVEL.<b><o:p></o:p></b></span></p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>determines if a transmit interrupt has occurred,
as determined by the shadow copy of the transmit interrupt ID register.<span
style='mso-spacerun:yes'>  </span>The driver then resets the shadow copy.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>releases the interrupt spin lock.</p>

<p class=MsoListParagraphCxSpMiddle style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>calls the function <b style='mso-bidi-font-weight:
normal'>SmscIrContinueBlasting </b>to continue the CIR transmit (if any
additional data is pending in the TxFifoDataList), if a transmit interrupt
occurred.</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in;mso-list:l2 level1 lfo10'><![if !supportLists]><span
style='font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol'><span style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>calls the function <b style='mso-bidi-font-weight:
normal'>SmscirEncodeAndEnqueueRLC</b> to convert the SIO1049 internal format
receive data to RLC and buffer it in the driver’s SMSCIR_RLC_RECEIVER data
structure.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>When the maximum number of loops has been completed, the
driver releases the TxFifoDataLock.<span style='mso-spacerun:yes'>  </span>It
then calls <b style='mso-bidi-font-weight:normal'>SmscIrProcessPendingReceives</b>
(which in turn calls <b>SmscIrDequeueRLCData</b><span style='mso-bidi-font-weight:
bold'>)</span> to attempt to satisfy and pending receive requests using the
data it has just received and translated.<span style='mso-spacerun:yes'> 
</span>The driver then drops the receive list spin lock, and calls an
appropriate variant of <b style='mso-bidi-font-weight:normal'>WdfRequestComplete</b>
if there is a newly completed receive or transmit request.</p>

<pre><span style='font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'><o:p>&nbsp;</o:p></span></pre><pre><span
style='font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'><o:p>&nbsp;</o:p></span></pre>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=624
 style='width:6.5in;mso-cellspacing:0in;mso-yfti-tbllook:1184;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes;
  height:1.5pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:1.5pt'>
  <p class=MsoNormal><span style='font-size:2.0pt;mso-bidi-font-size:12.0pt;
  font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<pre><span style='font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'><o:p>&nbsp;</o:p></span></pre>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'>© 2006
Microsoft Corporation</span><span style='font-size:10.0pt;font-family:"Verdana","sans-serif";
mso-bidi-font-family:Vrinda'> <o:p></o:p></span></p>

<pre><span style='font-family:"Verdana","sans-serif";mso-bidi-font-family:Vrinda'><o:p>&nbsp;</o:p></span></pre>

<p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='mso-bidi-font-size:10.0pt;font-family:"Verdana","sans-serif";mso-bidi-font-family:
Vrinda'><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>

